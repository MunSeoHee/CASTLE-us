{%extends 'base.html'%}
{%block contents%}
{%load static%}
<link rel="stylesheet" href="{%static 'groupParchase_detail.css'%}">
<div class="container">
    <!-- detail-body -->
    <div class="detail-body">
        <!-- detail-info -->
        <div class="detail-info">
            {%if groupParchase.proceeding == 1 %}
                <span class="process">진행중</span>
            {%else%}
                <span class="process">진행종료</span>
            {%endif%}
            <h1 class="detail-title">{{groupParchase.title}}</h1>
            <span class="user">{{groupParchase.writer}}</span>
            <span class="time"><i class="far fa-clock"></i>{{groupParchase.date}}</span>
        </div>
        <!-- carousel -->
        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
                <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="../media/images/아기의자.jpg" class="d-block w-100" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="../media/images/아기의자.jpg" class="d-block w-100" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="../media/images/아기의자.jpg" class="d-block w-100" alt="...">
                </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
        <!-- detail-content -->
        <p class="detail-content">
            {{groupParchase.contents}}
        </p>
    </div>
</div>
<div class="container container2">
    <!-- comments-part -->
    <div class="comments-part">
        <div class="comments-head">
            <h1 class="comments-title">댓글</h1>

            <!-- <span class="count-comments">{{allComments.count}}</span> -->
            
        </div>
        <div class="input-comment">
            <i class="far fa-grin"></i>
            <form class="input-group" method="GET" id="createComment" action ="{%url 'groupParchase_comment_new'%}">
                <input class="form-control" type="text" placeholder="댓글을 남겨 보세요." name="contents">
                <input type="text" value = "{{groupParchase.id}}" name="groupParchase_id" style="display: none;">
                <button type="submit" class="btn saveBtn" form="createComment">등록</button>
            </form>
        </div>
        {%for i in allComments.all%}
            {%if i.Group_buying_id == groupParchase.id%}
            <div class="comment">
                <img src="../media/images/아기의자.jpg" alt="user-image" class="user-image">
                <div class="comment-name-content" style="display: block;">
                    <h4 class="comment-name">{{i.user_info_id}}</h4>
                    <p class="comment-content">
                        {{i.contents}}
                    </p>
                    <div class="comment-etc">
                        <span class="write-time">2시간 전</span> <!--date 필드를 추가-->
                        <div class="comment-etc2">
                            <span class="like"><a><i class="fas fa-heart"></i>좋아요</a></span>
                        <span class="create-comments"><a>답글 달기</a></span>
                        <span class="report"><a>신고</a></span>
                        </div>
                    </div>
                    <div class="user-comment-add" style="margin: 1rem 0;">
                        <form class="input-group" method="GET" id="createComment2">
                            <i class="far fa-arrow-alt-circle-right"></i>
                            <input class="form-control" type="text" placeholder="댓글을 남겨 보세요." name="contents">
                            <button type="submit" class="btn saveBtn" form="createComment2">등록</button>
                        </form>
                    </div>
                </div>
            </div>
            {%endif%}
        {%endfor%}
    </div>
</div>
<script>
    const heart = document.querySelectorAll('.fa-heart');
        const like = document.querySelectorAll('.like');
        for(let i =0; i < like.length; i++){
            like[i].addEventListener('click', (e)=>{
                e.target.classList.toggle('toggle-like');
            })};

    const userCommentAdd = document.querySelectorAll('.user-comment-add');
    const createComment = document.querySelectorAll('.create-comments');
    for(let i=0; i< createComment.length; i++){
        console.log(createComment[i]);
        createComment[i].addEventListener('click', () => {
            userCommentAdd[i].classList.toggle('openComment');
        })
    }
</script>
{%endblock%}